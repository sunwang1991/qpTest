import{bb as H,aV as pe,a4 as se,au as re,aX as oe,a5 as ge,a6 as E,D as b,bf as ye,N as R,a7 as ce,a8 as K,aw as de,a_ as ie,ab as ue,I as fe,be as P,V as Ce,c as $,o as T,h as L,j as U,f as y,w as C,p as Z,t as I,k as e,J as S,ag as _,i as G,K as Y,bQ as be,E as ve,X as x,S as _e,T as Ee,ar as B,a$ as Te,r as q,b6 as Ve,bi as ee,bR as De,$ as te,al as we,at as ae,q as j,am as Ae,az as Pe,_ as $e,Z as Ne,af as Be}from"./index-G7k4jObO.js";import{E as Ue}from"./el-dialog-DIYJXQiP.js";import{E as le,a as Me}from"./el-checkbox-BDHvdtX6.js";import{E as Re}from"./el-row-ErebF3jE.js";const he="left-check-change",me="right-check-change",N=se({data:{type:E(Array),default:()=>[]},titles:{type:E(Array),default:()=>[]},buttonTexts:{type:E(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:E(Function)},leftDefaultChecked:{type:E(Array),default:()=>[]},rightDefaultChecked:{type:E(Array),default:()=>[]},renderContent:{type:E(Function)},modelValue:{type:E(Array),default:()=>[]},format:{type:E(Object),default:()=>({})},filterable:Boolean,props:{type:E(Object),default:()=>ge({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),z=(t,a)=>[t,a].every(H)||H(t)&&pe(a),Le={[oe]:(t,a,u)=>[t,u].every(H)&&["left","right"].includes(a),[re]:t=>H(t),[he]:z,[me]:z},Q="checked-change",Ie=se({data:N.data,optionRender:{type:E(Function)},placeholder:String,title:String,filterable:Boolean,format:N.format,filterMethod:N.filterMethod,defaultChecked:N.leftDefaultChecked,props:N.props}),Se={[Q]:z},F=t=>{const a={label:"label",key:"key",disabled:"disabled"};return b(()=>({...a,...t.props}))},qe=(t,a,u)=>{const n=F(t),f=b(()=>t.data.filter(l=>ye(t.filterMethod)?t.filterMethod(a.query,l):String(l[n.value.label]||l[n.value.key]).toLowerCase().includes(a.query.toLowerCase()))),r=b(()=>f.value.filter(l=>!l[n.value.disabled])),m=b(()=>{const l=a.checked.length,c=t.data.length,{noChecked:d,hasChecked:i}=t.format;return d&&i?l>0?i.replace(/\${checked}/g,l.toString()).replace(/\${total}/g,c.toString()):d.replace(/\${total}/g,c.toString()):`${l}/${c}`}),s=b(()=>{const l=a.checked.length;return l>0&&l<r.value.length}),p=()=>{const l=r.value.map(c=>c[n.value.key]);a.allChecked=l.length>0&&l.every(c=>a.checked.includes(c))},h=l=>{a.checked=l?r.value.map(c=>c[n.value.key]):[]};return R(()=>a.checked,(l,c)=>{if(p(),a.checkChangeByUser){const d=l.concat(c).filter(i=>!l.includes(i)||!c.includes(i));u(Q,l,d)}else u(Q,l),a.checkChangeByUser=!0}),R(r,()=>{p()}),R(()=>t.data,()=>{const l=[],c=f.value.map(d=>d[n.value.key]);a.checked.forEach(d=>{c.includes(d)&&l.push(d)}),a.checkChangeByUser=!1,a.checked=l}),R(()=>t.defaultChecked,(l,c)=>{if(c&&l.length===c.length&&l.every(g=>c.includes(g)))return;const d=[],i=r.value.map(g=>g[n.value.key]);l.forEach(g=>{i.includes(g)&&d.push(g)}),a.checkChangeByUser=!1,a.checked=d},{immediate:!0}),{filteredData:f,checkableData:r,checkedSummary:m,isIndeterminate:s,updateAllChecked:p,handleAllCheckedChange:h}},Fe=K({name:"ElTransferPanel"}),Oe=K({...Fe,props:Ie,emits:Se,setup(t,{expose:a,emit:u}){const n=t,f=de(),r=({option:k})=>k,{t:m}=ie(),s=ue("transfer"),p=fe({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),h=F(n),{filteredData:l,checkedSummary:c,isIndeterminate:d,handleAllCheckedChange:i}=qe(n,p,u),g=b(()=>!P(p.query)&&P(l.value)),w=b(()=>!P(f.default()[0].children)),{checked:V,allChecked:D,query:A}=Ce(p);return a({query:A}),(k,X)=>(T(),$("div",{class:_(e(s).b("panel"))},[L("p",{class:_(e(s).be("panel","header"))},[y(e(le),{modelValue:e(D),"onUpdate:modelValue":v=>S(D)?D.value=v:null,indeterminate:e(d),"validate-event":!1,onChange:e(i)},{default:C(()=>[Z(I(k.title)+" ",1),L("span",null,I(e(c)),1)]),_:1},8,["modelValue","onUpdate:modelValue","indeterminate","onChange"])],2),L("div",{class:_([e(s).be("panel","body"),e(s).is("with-footer",e(w))])},[k.filterable?(T(),G(e(ve),{key:0,modelValue:e(A),"onUpdate:modelValue":v=>S(A)?A.value=v:null,class:_(e(s).be("panel","filter")),size:"default",placeholder:k.placeholder,"prefix-icon":e(be),clearable:"","validate-event":!1},null,8,["modelValue","onUpdate:modelValue","class","placeholder","prefix-icon"])):U("v-if",!0),Y(y(e(Me),{modelValue:e(V),"onUpdate:modelValue":v=>S(V)?V.value=v:null,"validate-event":!1,class:_([e(s).is("filterable",k.filterable),e(s).be("panel","list")])},{default:C(()=>[(T(!0),$(_e,null,Ee(e(l),v=>(T(),G(e(le),{key:v[e(h).key],class:_(e(s).be("panel","item")),value:v[e(h).key],disabled:v[e(h).disabled],"validate-event":!1},{default:C(()=>{var M;return[y(r,{option:(M=k.optionRender)==null?void 0:M.call(k,v)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"]),[[x,!e(g)&&!e(P)(k.data)]]),Y(L("div",{class:_(e(s).be("panel","empty"))},[B(k.$slots,"empty",{},()=>[Z(I(e(g)?e(m)("el.transfer.noMatch"):e(m)("el.transfer.noData")),1)])],2),[[x,e(g)||e(P)(k.data)]])],2),e(w)?(T(),$("p",{key:0,class:_(e(s).be("panel","footer"))},[B(k.$slots,"default")],2)):U("v-if",!0)],2))}});var ne=ce(Oe,[["__file","transfer-panel.vue"]]);const He=t=>{const a=F(t),u=b(()=>t.data.reduce((r,m)=>(r[m[a.value.key]]=m)&&r,{})),n=b(()=>t.data.filter(r=>!t.modelValue.includes(r[a.value.key]))),f=b(()=>t.targetOrder==="original"?t.data.filter(r=>t.modelValue.includes(r[a.value.key])):t.modelValue.reduce((r,m)=>{const s=u.value[m];return s&&r.push(s),r},[]));return{sourceData:n,targetData:f}},Ge=(t,a,u)=>{const n=F(t),f=(s,p,h)=>{u(re,s),u(oe,s,p,h)};return{addToLeft:()=>{const s=t.modelValue.slice();a.rightChecked.forEach(p=>{const h=s.indexOf(p);h>-1&&s.splice(h,1)}),f(s,"left",a.rightChecked)},addToRight:()=>{let s=t.modelValue.slice();const p=t.data.filter(h=>{const l=h[n.value.key];return a.leftChecked.includes(l)&&!t.modelValue.includes(l)}).map(h=>h[n.value.key]);s=t.targetOrder==="unshift"?p.concat(s):s.concat(p),t.targetOrder==="original"&&(s=t.data.filter(h=>s.includes(h[n.value.key])).map(h=>h[n.value.key])),f(s,"right",a.leftChecked)}}},Ke=(t,a)=>({onSourceCheckedChange:(f,r)=>{t.leftChecked=f,r&&a(he,f,r)},onTargetCheckedChange:(f,r)=>{t.rightChecked=f,r&&a(me,f,r)}}),je=K({name:"ElTransfer"}),ze=K({...je,props:N,emits:Le,setup(t,{expose:a,emit:u}){const n=t,f=de(),{t:r}=ie(),m=ue("transfer"),{formItem:s}=Te(),p=fe({leftChecked:[],rightChecked:[]}),h=F(n),{sourceData:l,targetData:c}=He(n),{onSourceCheckedChange:d,onTargetCheckedChange:i}=Ke(p,u),{addToLeft:g,addToRight:w}=Ge(n,p,u),V=q(),D=q(),A=o=>{switch(o){case"left":V.value.query="";break;case"right":D.value.query="";break}},k=b(()=>n.buttonTexts.length===2),X=b(()=>n.titles[0]||r("el.transfer.titles.0")),v=b(()=>n.titles[1]||r("el.transfer.titles.1")),M=b(()=>n.filterPlaceholder||r("el.transfer.filterPlaceholder"));R(()=>n.modelValue,()=>{var o;n.validateEvent&&((o=s==null?void 0:s.validate)==null||o.call(s,"change").catch(O=>Ve()))});const J=b(()=>o=>{var O;if(n.renderContent)return n.renderContent(ee,o);const W=(((O=f.default)==null?void 0:O.call(f,{option:o}))||[]).filter(ke=>ke.type!==De);return W.length?W:ee("span",o[h.value.label]||o[h.value.key])});return a({clearQuery:A,leftPanel:V,rightPanel:D}),(o,O)=>(T(),$("div",{class:_(e(m).b())},[y(ne,{ref_key:"leftPanel",ref:V,data:e(l),"option-render":e(J),placeholder:e(M),title:e(X),filterable:o.filterable,format:o.format,"filter-method":o.filterMethod,"default-checked":o.leftDefaultChecked,props:n.props,onCheckedChange:e(d)},{empty:C(()=>[B(o.$slots,"left-empty")]),default:C(()=>[B(o.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),L("div",{class:_(e(m).e("buttons"))},[y(e(j),{type:"primary",class:_([e(m).e("button"),e(m).is("with-texts",e(k))]),disabled:e(P)(p.rightChecked),onClick:e(g)},{default:C(()=>[y(e(te),null,{default:C(()=>[y(e(we))]),_:1}),e(ae)(o.buttonTexts[0])?U("v-if",!0):(T(),$("span",{key:0},I(o.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),y(e(j),{type:"primary",class:_([e(m).e("button"),e(m).is("with-texts",e(k))]),disabled:e(P)(p.leftChecked),onClick:e(w)},{default:C(()=>[e(ae)(o.buttonTexts[1])?U("v-if",!0):(T(),$("span",{key:0},I(o.buttonTexts[1]),1)),y(e(te),null,{default:C(()=>[y(e(Ae))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),y(ne,{ref_key:"rightPanel",ref:D,data:e(c),"option-render":e(J),placeholder:e(M),filterable:o.filterable,format:o.format,"filter-method":o.filterMethod,title:e(v),"default-checked":o.rightDefaultChecked,props:n.props,onCheckedChange:e(i)},{empty:C(()=>[B(o.$slots,"right-empty")]),default:C(()=>[B(o.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var Qe=ce(ze,[["__file","transfer.vue"]]);const Xe=Pe(Qe),Je={__name:"index",props:{showSearch:{type:Boolean,default:!0},columns:{type:Array},search:{type:Boolean,default:!0},gutter:{type:Number,default:10}},emits:["update:showSearch","queryTable"],setup(t,{emit:a}){const u=t,n=a,f=q([]),r=q("显示/隐藏"),m=q(!1),s=b(()=>{const d={};return u.gutter&&(d.marginRight=`${u.gutter/2}px`),d});function p(){n("update:showSearch",!u.showSearch)}function h(){n("queryTable")}function l(d){for(let i in u.columns){const g=u.columns[i].key;u.columns[i].visible=!d.includes(g)}}function c(){m.value=!0}for(let d in u.columns)u.columns[d].visible===!1&&f.value.push(parseInt(d));return(d,i)=>{const g=j,w=Ne,V=Re,D=Xe,A=Ue;return T(),$("div",{class:"top-right-btn",style:Be(e(s))},[y(V,null,{default:C(()=>[t.search?(T(),G(w,{key:0,class:"item",effect:"dark",content:t.showSearch?"隐藏搜索":"显示搜索",placement:"top"},{default:C(()=>[y(g,{circle:"",icon:"Search",onClick:i[0]||(i[0]=k=>p())})]),_:1},8,["content"])):U("",!0),y(w,{class:"item",effect:"dark",content:"刷新",placement:"top"},{default:C(()=>[y(g,{circle:"",icon:"Refresh",onClick:i[1]||(i[1]=k=>h())})]),_:1}),t.columns?(T(),G(w,{key:1,class:"item",effect:"dark",content:"显隐列",placement:"top"},{default:C(()=>[y(g,{circle:"",icon:"Menu",onClick:i[2]||(i[2]=k=>c())})]),_:1})):U("",!0)]),_:1}),y(A,{title:e(r),modelValue:e(m),"onUpdate:modelValue":i[4]||(i[4]=k=>S(m)?m.value=k:null),"append-to-body":""},{default:C(()=>[y(D,{titles:["显示","隐藏"],modelValue:e(f),"onUpdate:modelValue":i[3]||(i[3]=k=>S(f)?f.value=k:null),data:t.columns,onChange:l},null,8,["modelValue","data"])]),_:1},8,["title","modelValue"])],4)}}},et=$e(Je,[["__scopeId","data-v-6d57bb7f"]]);export{et as _};
