import{M as I,d as j,r as u,W as A,c as D,o as d,K as f,f as e,X as F,k as t,w as n,E as G,n as R,Q as H,S as Y,T as Z,i as w,R as ee,J as T,q as oe,p as v,L as le,h as te,t as ae}from"./index-koRf1amC.js";/* empty css                   */import{_ as ne}from"./index-CSO0AOC1.js";import{a as re,E as se}from"./el-table-column-r1ysCLPE.js";import"./el-checkbox-HK0N5oFI.js";import{_ as ie}from"./index-C7JIz0oM.js";import{E as ue}from"./el-row-VKr6Yz4y.js";import{_ as pe}from"./index-CWBHHNWa.js";import{E as de}from"./el-col-BsYUv868.js";import{E as me,a as ge}from"./el-form-item-BLvtEj0w.js";import{E as fe}from"./el-date-picker-BzY-SmTT.js";import"./_baseClone-VCTtEV7x.js";import"./el-dialog-BKcY_UO0.js";import"./index-BaLWcWe0.js";function ce(x){return I({url:"/system/log/login/list",method:"get",params:x})}function _e(){return I({url:"/system/log/login/clean",method:"delete"})}const we={class:"app-container"},Te={__name:"index",setup(x){const{proxy:s}=j(),{sys_common_status:V}=s.useDict("sys_common_status"),N=u([]),b=u(!0),c=u(!0),y=u(0),m=u([]),h=u({prop:"loginTime",order:"descending"}),a=u({pageNum:1,pageSize:20,loginIp:"",userName:"",statusFlag:void 0,sortBy:void 0,sortOrder:void 0});function p(){b.value=!0,ce(s.addDateRange(a.value,m.value)).then(i=>{N.value=i.data.rows,y.value=i.data.total,b.value=!1})}function E(){a.value.pageNum=1,p()}function L(){m.value=[],s.resetForm("queryRef"),a.value.pageNum=1,s.$refs.logininforRef.sort(h.value.prop,h.value.order)}function B(i,o,S){a.value.sortBy=i.prop,a.value.sortOrder=i.order,p()}function U(){s.$modal.confirm("是否确认清空所有登录日志数据项?").then(function(){return _e()}).then(()=>{p(),s.$modal.msgSuccess("清空成功")}).catch(()=>{})}function P(){s.download("/system/log/login/export",{...a.value},`login_log_${new Date().getTime()}.xlsx`)}return p(),(i,o)=>{const S=G,g=me,q=ee,K=H,Q=fe,_=oe,$=ge,k=de,z=pe,O=ue,r=re,J=ie,M=se,W=ne,C=A("hasPermi"),X=le;return d(),D("div",we,[f(e($,{model:t(a),ref:"queryRef",inline:!0,"label-width":"68px"},{default:n(()=>[e(g,{label:"登录地址",prop:"loginIp"},{default:n(()=>[e(S,{modelValue:t(a).loginIp,"onUpdate:modelValue":o[0]||(o[0]=l=>t(a).loginIp=l),placeholder:"请输入登录地址",clearable:"",style:{width:"240px"},onKeyup:R(E,["enter"])},null,8,["modelValue"])]),_:1}),e(g,{label:"登录账号",prop:"userName"},{default:n(()=>[e(S,{modelValue:t(a).userName,"onUpdate:modelValue":o[1]||(o[1]=l=>t(a).userName=l),placeholder:"请输入登录账号",clearable:"",style:{width:"240px"},onKeyup:R(E,["enter"])},null,8,["modelValue"])]),_:1}),e(g,{label:"登录状态",prop:"statusFlag"},{default:n(()=>[e(K,{modelValue:t(a).statusFlag,"onUpdate:modelValue":o[2]||(o[2]=l=>t(a).statusFlag=l),placeholder:"登录状态",clearable:"",style:{width:"240px"}},{default:n(()=>[(d(!0),D(Y,null,Z(t(V),l=>(d(),w(q,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(g,{label:"登录时间",style:{width:"308px"}},{default:n(()=>[e(Q,{modelValue:t(m),"onUpdate:modelValue":o[3]||(o[3]=l=>T(m)?m.value=l:null),type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":[new Date(2e3,1,1,0,0,0),new Date(2e3,1,1,23,59,59)]},null,8,["modelValue","default-time"])]),_:1}),e(g,null,{default:n(()=>[e(_,{type:"primary",icon:"Search",onClick:E},{default:n(()=>o[7]||(o[7]=[v("搜索")])),_:1}),e(_,{icon:"Refresh",onClick:L},{default:n(()=>o[8]||(o[8]=[v("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[F,t(c)]]),e(O,{gutter:10,class:"mb8"},{default:n(()=>[e(k,{span:1.5},{default:n(()=>[f((d(),w(_,{type:"danger",plain:"",icon:"Delete",onClick:U},{default:n(()=>o[9]||(o[9]=[v("清空")])),_:1})),[[C,["monitor:logininfor:remove"]]])]),_:1}),e(k,{span:1.5},{default:n(()=>[f((d(),w(_,{type:"warning",plain:"",icon:"Download",onClick:P},{default:n(()=>o[10]||(o[10]=[v(" 导出 ")])),_:1})),[[C,["monitor:logininfor:export"]]])]),_:1}),e(z,{showSearch:t(c),"onUpdate:showSearch":o[4]||(o[4]=l=>T(c)?c.value=l:null),onQueryTable:p},null,8,["showSearch"])]),_:1}),f((d(),w(M,{ref:"logininforRef",data:t(N),"default-sort":t(h),onSortChange:B},{default:n(()=>[e(r,{label:"日志编号",align:"left",prop:"id"}),e(r,{label:"登录账号",align:"left",prop:"userName","show-overflow-tooltip":!0,sortable:"custom","sort-orders":["descending","ascending"]}),e(r,{label:"登录地址",align:"left",prop:"loginIp","show-overflow-tooltip":!0}),e(r,{label:"登录地点",align:"left",prop:"loginLocation","show-overflow-tooltip":!0}),e(r,{label:"操作系统",align:"left",prop:"os","show-overflow-tooltip":!0}),e(r,{label:"浏览器",align:"left",prop:"browser","show-overflow-tooltip":!0}),e(r,{label:"登录状态",align:"left",prop:"statusFlag"},{default:n(l=>[e(J,{options:t(V),value:l.row.statusFlag},null,8,["options","value"])]),_:1}),e(r,{label:"登录信息",align:"left",prop:"msg","show-overflow-tooltip":!0}),e(r,{label:"登录时间",align:"left",prop:"loginTime",sortable:"custom","sort-orders":["descending","ascending"],width:"180"},{default:n(l=>[te("span",null,ae(i.parseTime(l.row.loginTime)),1)]),_:1})]),_:1},8,["data","default-sort"])),[[X,t(b)]]),f(e(W,{total:t(y),page:t(a).pageNum,"onUpdate:page":o[5]||(o[5]=l=>t(a).pageNum=l),limit:t(a).pageSize,"onUpdate:limit":o[6]||(o[6]=l=>t(a).pageSize=l),onPagination:p},null,8,["total","page","limit"]),[[F,t(y)>0]])])}}};export{Te as default};
