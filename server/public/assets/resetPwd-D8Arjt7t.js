import{a as _,b,d as V,I as x,r as y,i as E,o as q,w as a,f as s,E as U,k as r,q as h,p as w,A as B,B as k}from"./index-G7k4jObO.js";import{E as C,a as I}from"./el-form-item-BuGiXd-d.js";import{h as T}from"./user-WxlmjGaf.js";import"./_baseClone-BzXbRH51.js";const $={__name:"resetPwd",setup(v){const m=_(),i=b(),{proxy:u}=V(),o=x({oldPassword:"",newPassword:"",confirmPassword:""}),f=y({oldPassword:[{required:!0,message:"旧密码不能为空",trigger:"blur"}],newPassword:[{required:!0,message:"新密码密码至少包含大小写字母、数字、特殊符号，且不少于6位",trigger:"blur",pattern:k},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{required:!0,validator:(n,e,t)=>{o.newPassword!==e?t(new Error("两次输入的密码不一致")):t()},trigger:"blur"}]});function c(){u.$refs.pwdRef.validate(n=>{n&&T(o.oldPassword,o.newPassword).then(e=>{B.alert("<font color='#67c23a'>修改成功</font>","系统提示",{dangerouslyUseHTMLString:!0,type:"success"}).then(()=>{i.logOut().then(()=>{m.push("/login")})}).catch(()=>{})})})}function P(){u.$tab.closePage()}return(n,e)=>{const t=U,d=C,p=h,g=I;return q(),E(g,{ref:"pwdRef",model:r(o),rules:r(f),"label-width":"80px"},{default:a(()=>[s(d,{label:"旧密码",prop:"oldPassword"},{default:a(()=>[s(t,{modelValue:r(o).oldPassword,"onUpdate:modelValue":e[0]||(e[0]=l=>r(o).oldPassword=l),placeholder:"请输入旧密码",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),s(d,{label:"新密码",prop:"newPassword"},{default:a(()=>[s(t,{modelValue:r(o).newPassword,"onUpdate:modelValue":e[1]||(e[1]=l=>r(o).newPassword=l),placeholder:"请输入新密码",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),s(d,{label:"确认密码",prop:"confirmPassword"},{default:a(()=>[s(t,{modelValue:r(o).confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>r(o).confirmPassword=l),placeholder:"请确认新密码",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),s(d,null,{default:a(()=>[s(p,{type:"primary",onClick:c},{default:a(()=>e[3]||(e[3]=[w("保存")])),_:1}),s(p,{type:"danger",onClick:P},{default:a(()=>e[4]||(e[4]=[w("关闭")])),_:1})]),_:1})]),_:1},8,["model","rules"])}}};export{$ as default};
