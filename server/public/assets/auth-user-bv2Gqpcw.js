import{u as W,d as X,r as d,I as G,W as H,c as U,o as i,K as c,f as l,X as V,k as t,w as a,E as M,n as F,Q as Y,S as Z,T as ee,i as g,R as le,q as te,p as f,J as oe,L as ae,h as ne,t as se}from"./index-G7k4jObO.js";/* empty css                   */import{_ as re}from"./index-lnQ7o6NH.js";import{a as ue,E as ie}from"./el-table-column-DdgShedu.js";import"./el-checkbox-BDHvdtX6.js";import{_ as pe}from"./index-MQ6fygIi.js";import{E as me}from"./el-row-ErebF3jE.js";import{_ as de}from"./index-1r1_z5ZC.js";import{E as ce}from"./el-col-B8uK4B1i.js";import{E as fe,a as _e}from"./el-form-item-BuGiXd-d.js";import ge from"./auth-user-select-CHvaLepm.js";import{a as he,b as be,c as we}from"./role-Bb5bpIV4.js";import"./_baseClone-BzXbRH51.js";import"./el-dialog-DIYJXQiP.js";const ve={class:"app-container"},Be={__name:"auth-user",setup(ye){const R=W(),{proxy:r}=X(),{sys_normal_disable:C}=r.useDict("sys_normal_disable"),S=d([]),w=d(!0),h=d(!0),E=d(!0),v=d(0),k=d([]),n=G({pageNum:1,pageSize:20,auth:!0,roleId:R.params.roleId,userName:void 0,phone:void 0,statusFlag:void 0});function p(){w.value=!0,he(n).then(s=>{S.value=s.data.rows,v.value=s.data.total,w.value=!1})}function x(){const s={path:"/system/role"};r.$tab.closeOpenPage(s)}function _(){n.pageNum=1,p()}function T(){r.resetForm("queryRef"),_()}function $(s){k.value=s.map(e=>e.userId),E.value=!s.length}function L(){r.$refs.selectRef.show()}function P(s){r.$modal.confirm('确认要取消该用户"'+s.userName+'"角色吗？').then(function(){return we({auth:!1,userIds:[parseInt(s.userId)],roleId:parseInt(n.roleId)})}).then(()=>{p(),r.$modal.msgSuccess("取消授权成功")}).catch(()=>{})}function B(s){r.$modal.confirm("是否取消选中用户授权数据项?").then(function(){return be({auth:!1,userIds:k.value.map(e=>parseInt(e)),roleId:parseInt(n.roleId)})}).then(()=>{p(),r.$modal.msgSuccess("取消授权成功")}).catch(()=>{})}return p(),(s,e)=>{const N=M,b=fe,q=le,A=Y,m=te,D=_e,y=ce,K=de,Q=me,u=ue,z=pe,O=ie,j=re,I=H("hasPermi"),J=ae;return i(),U("div",ve,[c(l(D,{model:t(n),ref:"queryRef",inline:!0},{default:a(()=>[l(b,{label:"登录账号",prop:"userName"},{default:a(()=>[l(N,{modelValue:t(n).userName,"onUpdate:modelValue":e[0]||(e[0]=o=>t(n).userName=o),placeholder:"请输入登录账号",clearable:"",style:{width:"240px"},onKeyup:F(_,["enter"])},null,8,["modelValue"])]),_:1}),l(b,{label:"手机号码",prop:"phone"},{default:a(()=>[l(N,{modelValue:t(n).phone,"onUpdate:modelValue":e[1]||(e[1]=o=>t(n).phone=o),placeholder:"请输入手机号码",clearable:"",style:{width:"240px"},onKeyup:F(_,["enter"])},null,8,["modelValue"])]),_:1}),l(b,{label:"用户状态",prop:"statusFlag"},{default:a(()=>[l(A,{modelValue:t(n).statusFlag,"onUpdate:modelValue":e[2]||(e[2]=o=>t(n).statusFlag=o),placeholder:"用户状态",clearable:"",style:{width:"240px"}},{default:a(()=>[(i(!0),U(Z,null,ee(t(C),o=>(i(),g(q,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(b,null,{default:a(()=>[l(m,{type:"primary",icon:"Search",onClick:_},{default:a(()=>e[6]||(e[6]=[f("搜索")])),_:1}),l(m,{icon:"Refresh",onClick:T},{default:a(()=>e[7]||(e[7]=[f("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[V,t(h)]]),l(Q,{gutter:10,class:"mb8"},{default:a(()=>[l(y,{span:1.5},{default:a(()=>[c((i(),g(m,{type:"primary",plain:"",icon:"Plus",onClick:L},{default:a(()=>e[8]||(e[8]=[f("添加用户")])),_:1})),[[I,["system:role:add"]]])]),_:1}),l(y,{span:1.5},{default:a(()=>[c((i(),g(m,{type:"danger",plain:"",icon:"CircleClose",disabled:t(E),onClick:B},{default:a(()=>e[9]||(e[9]=[f("批量取消授权")])),_:1},8,["disabled"])),[[I,["system:role:remove"]]])]),_:1}),l(y,{span:1.5},{default:a(()=>[l(m,{type:"warning",plain:"",icon:"Close",onClick:x},{default:a(()=>e[10]||(e[10]=[f("关闭")])),_:1})]),_:1}),l(K,{showSearch:t(h),"onUpdate:showSearch":e[3]||(e[3]=o=>oe(h)?h.value=o:null),onQueryTable:p},null,8,["showSearch"])]),_:1}),c((i(),g(O,{data:t(S),onSelectionChange:$},{default:a(()=>[l(u,{type:"selection",width:"55",align:"left"}),l(u,{label:"登录账号",prop:"userName","show-overflow-tooltip":!0}),l(u,{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}),l(u,{label:"邮箱",prop:"email","show-overflow-tooltip":!0}),l(u,{label:"手机",prop:"phone","show-overflow-tooltip":!0}),l(u,{label:"状态",align:"left",prop:"statusFlag"},{default:a(o=>[l(z,{options:t(C),value:o.row.statusFlag},null,8,["options","value"])]),_:1}),l(u,{label:"创建时间",align:"left",prop:"createTime",width:"180"},{default:a(o=>[ne("span",null,se(s.parseTime(o.row.createTime)),1)]),_:1}),l(u,{label:"操作",align:"left","class-name":"small-padding fixed-width"},{default:a(o=>[c((i(),g(m,{link:"",type:"primary",icon:"CircleClose",onClick:Ie=>P(o.row)},{default:a(()=>e[11]||(e[11]=[f("取消授权")])),_:2},1032,["onClick"])),[[I,["system:role:remove"]]])]),_:1})]),_:1},8,["data"])),[[J,t(w)]]),c(l(j,{total:t(v),page:t(n).pageNum,"onUpdate:page":e[4]||(e[4]=o=>t(n).pageNum=o),limit:t(n).pageSize,"onUpdate:limit":e[5]||(e[5]=o=>t(n).pageSize=o),onPagination:p},null,8,["total","page","limit"]),[[V,t(v)>0]]),l(t(ge),{ref:"selectRef",roleId:t(n).roleId,onOk:_},null,8,["roleId"])])}}};export{Be as default};
