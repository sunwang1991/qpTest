import{b_ as $e,bw as xe,aq as fe,a4 as Ie,a6 as Z,a5 as ze,a7 as _e,a8 as oe,cW as we,cX as Re,cY as Pe,a_ as Le,ab as Ce,cZ as Ae,r as b,c_ as Me,a1 as Be,D as p,N as ve,ac as Ee,O as Se,i as me,o as y,w as g,f as c,bz as Ve,h,af as ye,ag as m,k as a,cy as Xe,j as I,c as L,ar as $,s as Ye,$ as T,ao as De,S as ne,al as Fe,am as je,p as He,t as Ne,c$ as Ke,d0 as We,b9 as qe,d1 as Ze,d2 as Ue,T as Ge,K as Je,X as Qe,cz as ea,bO as X,d3 as aa,an as V,az as Oe,bp as sa,d4 as ta,bn as na,bh as q,bb as oa,U as he,d5 as be,d6 as ke,cj as la,ap as ra,d7 as ia,d8 as ca,d9 as ua}from"./index-G7k4jObO.js";var da="Expected a function";function de(u,R,d){var f=!0,n=!0;if(typeof u!="function")throw new TypeError(da);return $e(d)&&(f="leading"in d?!!d.leading:f,n="trailing"in d?!!d.trailing:n),xe(u,R,{leading:f,maxWait:R,trailing:n})}const fa=Ie({urlList:{type:Z(Array),default:()=>ze([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:Z(String)}}),va={close:()=>!0,switch:u=>fe(u),rotate:u=>fe(u)},ma=oe({name:"ElImageViewer"}),pa=oe({...ma,props:fa,emits:va,setup(u,{expose:R,emit:d}){var f;const n=u,x={CONTAIN:{name:"contain",icon:we(Pe)},ORIGINAL:{name:"original",icon:we(Re)}},{t:C}=Le(),o=Ce("image-viewer"),{nextZIndex:U}=Ae(),Y=b(),P=b([]),S=Me(),w=b(!0),v=b(n.initialIndex),E=Be(x.CONTAIN),t=b({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),le=b((f=n.zIndex)!=null?f:U()),D=p(()=>{const{urlList:s}=n;return s.length<=1}),A=p(()=>v.value===0),G=p(()=>v.value===n.urlList.length-1),re=p(()=>n.urlList[v.value]),F=p(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!n.infinite&&A.value)]),ie=p(()=>[o.e("btn"),o.e("next"),o.is("disabled",!n.infinite&&G.value)]),J=p(()=>{const{scale:s,deg:i,offsetX:l,offsetY:k,enableTransition:z}=t.value;let _=l/s,O=k/s;const W=i*Math.PI/180,pe=Math.cos(W),ge=Math.sin(W);_=_*pe+O*ge,O=O*pe-l/s*ge;const ue={transform:`scale(${s}) rotate(${i}deg) translate(${_}px, ${O}px)`,transition:z?"transform .3s":""};return E.value.name===x.CONTAIN.name&&(ue.maxWidth=ue.maxHeight="100%"),ue}),j=p(()=>`${v.value+1} / ${n.urlList.length}`);function M(){Q(),d("close")}function ce(){const s=de(l=>{switch(l.code){case V.esc:n.closeOnPressEscape&&M();break;case V.space:B();break;case V.left:K();break;case V.up:r("zoomIn");break;case V.right:e();break;case V.down:r("zoomOut");break}}),i=de(l=>{const k=l.deltaY||l.deltaX;r(k<0?"zoomIn":"zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})});S.run(()=>{X(document,"keydown",s),X(document,"wheel",i)})}function Q(){S.stop()}function ee(){w.value=!1}function ae(s){w.value=!1,s.target.alt=C("el.image.error")}function se(s){if(w.value||s.button!==0||!Y.value)return;t.value.enableTransition=!1;const{offsetX:i,offsetY:l}=t.value,k=s.pageX,z=s.pageY,_=de(W=>{t.value={...t.value,offsetX:i+W.pageX-k,offsetY:l+W.pageY-z}}),O=X(document,"mousemove",_);X(document,"mouseup",()=>{O()}),s.preventDefault()}function te(){t.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function B(){if(w.value)return;const s=aa(x),i=Object.values(x),l=E.value.name,z=(i.findIndex(_=>_.name===l)+1)%s.length;E.value=x[s[z]],te()}function H(s){const i=n.urlList.length;v.value=(s+i)%i}function K(){A.value&&!n.infinite||H(v.value-1)}function e(){G.value&&!n.infinite||H(v.value+1)}function r(s,i={}){if(w.value)return;const{minScale:l,maxScale:k}=n,{zoomRate:z,rotateDeg:_,enableTransition:O}={zoomRate:n.zoomRate,rotateDeg:90,enableTransition:!0,...i};switch(s){case"zoomOut":t.value.scale>l&&(t.value.scale=Number.parseFloat((t.value.scale/z).toFixed(3)));break;case"zoomIn":t.value.scale<k&&(t.value.scale=Number.parseFloat((t.value.scale*z).toFixed(3)));break;case"clockwise":t.value.deg+=_,d("rotate",t.value.deg);break;case"anticlockwise":t.value.deg-=_,d("rotate",t.value.deg);break}t.value.enableTransition=O}function N(s){var i;((i=s.detail)==null?void 0:i.focusReason)==="pointer"&&s.preventDefault()}function Te(){n.closeOnPressEscape&&M()}return ve(re,()=>{Ee(()=>{const s=P.value[0];s!=null&&s.complete||(w.value=!0)})}),ve(v,s=>{te(),d("switch",s)}),Se(()=>{ce()}),R({setActiveItem:H}),(s,i)=>(y(),me(a(ea),{to:"body",disabled:!s.teleported},{default:g(()=>[c(Ve,{name:"viewer-fade",appear:""},{default:g(()=>[h("div",{ref_key:"wrapper",ref:Y,tabindex:-1,class:m(a(o).e("wrapper")),style:ye({zIndex:le.value})},[c(a(Xe),{loop:"",trapped:"","focus-trap-el":Y.value,"focus-start-el":"container",onFocusoutPrevented:N,onReleaseRequested:Te},{default:g(()=>[h("div",{class:m(a(o).e("mask")),onClick:Ye(l=>s.hideOnClickModal&&M(),["self"])},null,10,["onClick"]),I(" CLOSE "),h("span",{class:m([a(o).e("btn"),a(o).e("close")]),onClick:M},[c(a(T),null,{default:g(()=>[c(a(De))]),_:1})],2),I(" ARROW "),a(D)?I("v-if",!0):(y(),L(ne,{key:0},[h("span",{class:m(a(F)),onClick:K},[c(a(T),null,{default:g(()=>[c(a(Fe))]),_:1})],2),h("span",{class:m(a(ie)),onClick:e},[c(a(T),null,{default:g(()=>[c(a(je))]),_:1})],2)],64)),s.showProgress?(y(),L("div",{key:1,class:m([a(o).e("btn"),a(o).e("progress")])},[$(s.$slots,"progress",{activeIndex:v.value,total:s.urlList.length},()=>[He(Ne(a(j)),1)])],2)):I("v-if",!0),I(" ACTIONS "),h("div",{class:m([a(o).e("btn"),a(o).e("actions")])},[h("div",{class:m(a(o).e("actions__inner"))},[$(s.$slots,"toolbar",{actions:r,prev:K,next:e,reset:B,activeIndex:v.value},()=>[c(a(T),{onClick:l=>r("zoomOut")},{default:g(()=>[c(a(Ke))]),_:1},8,["onClick"]),c(a(T),{onClick:l=>r("zoomIn")},{default:g(()=>[c(a(We))]),_:1},8,["onClick"]),h("i",{class:m(a(o).e("actions__divider"))},null,2),c(a(T),{onClick:B},{default:g(()=>[(y(),me(qe(a(E).icon)))]),_:1}),h("i",{class:m(a(o).e("actions__divider"))},null,2),c(a(T),{onClick:l=>r("anticlockwise")},{default:g(()=>[c(a(Ze))]),_:1},8,["onClick"]),c(a(T),{onClick:l=>r("clockwise")},{default:g(()=>[c(a(Ue))]),_:1},8,["onClick"])])],2)],2),I(" CANVAS "),h("div",{class:m(a(o).e("canvas"))},[(y(!0),L(ne,null,Ge(s.urlList,(l,k)=>Je((y(),L("img",{ref_for:!0,ref:z=>P.value[k]=z,key:l,src:l,style:ye(a(J)),class:m(a(o).e("img")),crossorigin:s.crossorigin,onLoad:ee,onError:ae,onMousedown:se},null,46,["src","crossorigin"])),[[Qe,k===v.value]])),128))],2),$(s.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var ga=_e(pa,[["__file","image-viewer.vue"]]);const wa=Oe(ga),ya=Ie({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:Z([String,Object])},previewSrcList:{type:Z(Array),default:()=>ze([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:Z(String)}}),ha={load:u=>u instanceof Event,error:u=>u instanceof Event,switch:u=>fe(u),close:()=>!0,show:()=>!0},ba=oe({name:"ElImage",inheritAttrs:!1}),ka=oe({...ba,props:ya,emits:ha,setup(u,{expose:R,emit:d}){const f=u;let n="";const{t:x}=Le(),C=Ce("image"),o=sa(),U=p(()=>ta(Object.entries(o).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),Y=na({excludeListeners:!0,excludeKeys:p(()=>Object.keys(U.value))}),P=b(),S=b(!1),w=b(!0),v=b(!1),E=b(),t=b(),le=q&&"loading"in HTMLImageElement.prototype;let D,A;const G=p(()=>[C.e("inner"),F.value&&C.e("preview"),w.value&&C.is("loading")]),re=p(()=>{const{fit:e}=f;return q&&e?{objectFit:e}:{}}),F=p(()=>{const{previewSrcList:e}=f;return oa(e)&&e.length>0}),ie=p(()=>{const{previewSrcList:e,initialIndex:r}=f;let N=r;return r>e.length-1&&(N=0),N}),J=p(()=>f.loading==="eager"?!1:!le&&f.loading==="lazy"||f.lazy),j=()=>{q&&(w.value=!0,S.value=!1,P.value=f.src)};function M(e){w.value=!1,S.value=!1,d("load",e)}function ce(e){w.value=!1,S.value=!0,d("error",e)}function Q(){ca(E.value,t.value)&&(j(),se())}const ee=ua(Q,200,!0);async function ae(){var e;if(!q)return;await Ee();const{scrollContainer:r}=f;la(r)?t.value=r:ra(r)&&r!==""?t.value=(e=document.querySelector(r))!=null?e:void 0:E.value&&(t.value=ia(E.value)),t.value&&(D=X(t,"scroll",ee),setTimeout(()=>Q(),100))}function se(){!q||!t.value||!ee||(D==null||D(),t.value=void 0)}function te(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function B(){F.value&&(A=X("wheel",te,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",v.value=!0,d("show"))}function H(){A==null||A(),document.body.style.overflow=n,v.value=!1,d("close")}function K(e){d("switch",e)}return ve(()=>f.src,()=>{J.value?(w.value=!0,S.value=!1,se(),ae()):j()}),Se(()=>{J.value?ae():j()}),R({showPreview:B}),(e,r)=>(y(),L("div",he({ref_key:"container",ref:E},a(U),{class:[a(C).b(),e.$attrs.class]}),[S.value?$(e.$slots,"error",{key:0},()=>[h("div",{class:m(a(C).e("error"))},Ne(a(x)("el.image.error")),3)]):(y(),L(ne,{key:1},[P.value!==void 0?(y(),L("img",he({key:0},a(Y),{src:P.value,loading:e.loading,style:a(re),class:a(G),crossorigin:e.crossorigin,onClick:B,onLoad:M,onError:ce}),null,16,["src","loading","crossorigin"])):I("v-if",!0),w.value?(y(),L("div",{key:1,class:m(a(C).e("wrapper"))},[$(e.$slots,"placeholder",{},()=>[h("div",{class:m(a(C).e("placeholder"))},null,2)])],2)):I("v-if",!0)],64)),a(F)?(y(),L(ne,{key:2},[v.value?(y(),me(a(wa),{key:0,"z-index":e.zIndex,"initial-index":a(ie),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"show-progress":e.showProgress,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:H,onSwitch:K},{progress:g(N=>[$(e.$slots,"progress",be(ke(N)))]),toolbar:g(N=>[$(e.$slots,"toolbar",be(ke(N)))]),default:g(()=>[e.$slots.viewer?(y(),L("div",{key:0},[$(e.$slots,"viewer")])):I("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):I("v-if",!0)],64)):I("v-if",!0)],16))}});var Ia=_e(ka,[["__file","image.vue"]]);const _a=Oe(Ia);export{_a as E};
