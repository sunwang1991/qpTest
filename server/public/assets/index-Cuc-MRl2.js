import{M as h,d as ie,r as c,I as me,aB as fe,aC as _e,V as ce,W as ge,c as R,o as p,K as b,f as t,j as A,X as ve,k as o,w as l,E as ye,n as be,Q as he,S as L,T as Q,i as g,R as Ve,q as Ee,p as i,J as K,L as ke,h as M,t as O,ac as Ie}from"./index-G7k4jObO.js";/* empty css                   */import{E as we}from"./el-dialog-DIYJXQiP.js";import{E as xe,b as Ce}from"./el-radio-D3_6fv-a.js";import{E as Se}from"./el-input-number-BiqDyfz5.js";import"./el-tree-B-MLhPxD.js";import"./el-checkbox-BDHvdtX6.js";import{E as Ne}from"./el-tree-select-DqDPPnyi.js";import{a as Fe,E as Te}from"./el-table-column-DdgShedu.js";import{_ as De}from"./index-MQ6fygIi.js";import{E as Re}from"./el-row-ErebF3jE.js";import{_ as Ue}from"./index-1r1_z5ZC.js";import{E as $e}from"./el-col-B8uK4B1i.js";import{E as qe,a as Be}from"./el-form-item-BuGiXd-d.js";import"./index-BgiGdtQm.js";import"./_baseClone-BzXbRH51.js";function j(r){return h({url:"/system/dept/list",method:"get",params:r})}function Pe(r){return h({url:`/system/dept/list/exclude/${r}`,method:"get"})}function Ae(r){return h({url:"/system/dept/"+r,method:"get"})}function Le(r){return h({url:"/system/dept",method:"post",data:r})}function Qe(r){return h({url:"/system/dept",method:"put",data:r})}function Ke(r){return h({url:"/system/dept/"+r,method:"delete"})}const Me={class:"app-container"},Oe={class:"dialog-footer"},rt={__name:"index",setup(r){const{proxy:u}=ie(),{sys_normal_disable:x}=u.useDict("sys_normal_disable"),U=c([]),_=c(!1),C=c(!0),k=c(!0),S=c(""),I=c([]),N=c(!0),F=c(!0),G=me({form:{},queryParams:{deptName:"",statusFlag:void 0},rules:{parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],deptSort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],email:[{pattern:_e,message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:fe,message:"请输入正确的手机号码",trigger:"blur"}]}}),{queryParams:v,form:n,rules:J}=ce(G);function y(){C.value=!0,j(v.value).then(d=>{U.value=u.handleTree(d.data,"deptId"),C.value=!1})}function W(){_.value=!1,T()}function T(){n.value={deptId:void 0,parentId:100,deptName:"",deptSort:0,leader:"",phone:"",email:"",statusFlag:"0"},u.resetForm("deptRef")}function D(){y()}function X(){u.resetForm("queryRef"),D()}function $(d){T(),j().then(e=>{I.value=u.handleTree(e.data,"deptId")}),d&&(n.value.parentId=d.deptId),_.value=!0,S.value="添加部门"}function z(){F.value=!1,N.value=!N.value,Ie(()=>{F.value=!0})}function H(d){T(),Pe(d.deptId).then(e=>{Array.isArray(e.data)&&e.data.length==0?I.value=[{deptId:0,parentId:0,deptName:"根节点"}]:I.value=u.handleTree(e.data,"deptId")}),Ae(d.deptId).then(e=>{n.value=e.data,_.value=!0,S.value="修改部门"})}function Y(){u.$refs.deptRef.validate(d=>{d&&(n.value.deptId?Qe(n.value).then(e=>{u.$modal.msgSuccess("修改成功"),_.value=!1,y()}):Le(n.value).then(e=>{u.$modal.msgSuccess("新增成功"),_.value=!1,y()}))})}function Z(d){u.$modal.confirm('是否确认删除名称为"'+d.deptName+'"的数据项?').then(function(){return Ke(d.deptId)}).then(()=>{y(),u.$modal.msgSuccess("删除成功")}).catch(()=>{})}return y(),(d,e)=>{const V=ye,s=qe,ee=Ve,te=he,m=Ee,q=Be,f=$e,le=Ue,B=Re,E=Fe,ae=De,oe=Te,ne=Ne,de=Se,re=Ce,ue=xe,se=we,w=ge("hasPermi"),pe=ke;return p(),R("div",Me,[b(t(q,{model:o(v),ref:"queryRef",inline:!0},{default:l(()=>[t(s,{label:"部门名称",prop:"deptName"},{default:l(()=>[t(V,{modelValue:o(v).deptName,"onUpdate:modelValue":e[0]||(e[0]=a=>o(v).deptName=a),placeholder:"请输入部门名称",clearable:"",style:{width:"200px"},onKeyup:be(D,["enter"])},null,8,["modelValue"])]),_:1}),t(s,{label:"状态",prop:"statusFlag"},{default:l(()=>[t(te,{modelValue:o(v).statusFlag,"onUpdate:modelValue":e[1]||(e[1]=a=>o(v).statusFlag=a),placeholder:"部门状态",clearable:"",style:{width:"200px"}},{default:l(()=>[(p(!0),R(L,null,Q(o(x),a=>(p(),g(ee,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(s,null,{default:l(()=>[t(m,{type:"primary",icon:"Search",onClick:D},{default:l(()=>e[12]||(e[12]=[i("搜索")])),_:1}),t(m,{icon:"Refresh",onClick:X},{default:l(()=>e[13]||(e[13]=[i("重置")])),_:1})]),_:1})]),_:1},8,["model"]),[[ve,o(k)]]),t(B,{gutter:10,class:"mb8"},{default:l(()=>[t(f,{span:1.5},{default:l(()=>[b((p(),g(m,{type:"primary",plain:"",icon:"Plus",onClick:e[2]||(e[2]=a=>$())},{default:l(()=>e[14]||(e[14]=[i("新增")])),_:1})),[[w,["system:dept:add"]]])]),_:1}),t(f,{span:1.5},{default:l(()=>[t(m,{type:"info",plain:"",icon:"Sort",onClick:z},{default:l(()=>e[15]||(e[15]=[i("展开/折叠")])),_:1})]),_:1}),t(le,{showSearch:o(k),"onUpdate:showSearch":e[3]||(e[3]=a=>K(k)?k.value=a:null),onQueryTable:y},null,8,["showSearch"])]),_:1}),o(F)?b((p(),g(oe,{key:0,data:o(U),"row-key":"deptId","default-expand-all":o(N),"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:l(()=>[t(E,{prop:"deptName",label:"部门名称",width:"260"}),t(E,{prop:"deptSort",label:"排序",width:"200"}),t(E,{prop:"statusFlag",label:"状态",width:"100"},{default:l(a=>[t(ae,{options:o(x),value:a.row.statusFlag},null,8,["options","value"])]),_:1}),t(E,{label:"创建时间",align:"left",prop:"createTime",width:"200"},{default:l(a=>[M("span",null,O(d.parseTime(a.row.createTime)),1)]),_:1}),t(E,{label:"操作",align:"left","class-name":"small-padding fixed-width"},{default:l(a=>[b((p(),g(m,{link:"",type:"primary",icon:"Edit",onClick:P=>H(a.row)},{default:l(()=>e[16]||(e[16]=[i("修改")])),_:2},1032,["onClick"])),[[w,["system:dept:edit"]]]),b((p(),g(m,{link:"",type:"primary",icon:"Plus",onClick:P=>$(a.row)},{default:l(()=>e[17]||(e[17]=[i("新增")])),_:2},1032,["onClick"])),[[w,["system:dept:add"]]]),a.row.parentId!=0?b((p(),g(m,{key:0,link:"",type:"primary",icon:"Delete",onClick:P=>Z(a.row)},{default:l(()=>e[18]||(e[18]=[i("删除")])),_:2},1032,["onClick"])),[[w,["system:dept:remove"]]]):A("",!0)]),_:1})]),_:1},8,["data","default-expand-all"])),[[pe,o(C)]]):A("",!0),t(se,{title:o(S),modelValue:o(_),"onUpdate:modelValue":e[11]||(e[11]=a=>K(_)?_.value=a:null),width:"600px","append-to-body":""},{footer:l(()=>[M("div",Oe,[t(m,{type:"primary",onClick:Y},{default:l(()=>e[19]||(e[19]=[i("确 定")])),_:1}),t(m,{onClick:W},{default:l(()=>e[20]||(e[20]=[i("取 消")])),_:1})])]),default:l(()=>[t(q,{ref:"deptRef",model:o(n),rules:o(J),"label-width":"80px"},{default:l(()=>[t(B,null,{default:l(()=>[t(f,{span:24},{default:l(()=>[t(s,{label:"上级部门",prop:"parentId"},{default:l(()=>[t(ne,{modelValue:o(n).parentId,"onUpdate:modelValue":e[4]||(e[4]=a=>o(n).parentId=a),data:o(I),props:{value:"deptId",label:"deptName",children:"children"},"value-key":"deptId",placeholder:"选择上级部门","check-strictly":""},null,8,["modelValue","data"])]),_:1})]),_:1}),t(f,{span:12},{default:l(()=>[t(s,{label:"部门名称",prop:"deptName"},{default:l(()=>[t(V,{modelValue:o(n).deptName,"onUpdate:modelValue":e[5]||(e[5]=a=>o(n).deptName=a),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{span:12},{default:l(()=>[t(s,{label:"显示排序",prop:"deptSort"},{default:l(()=>[t(de,{modelValue:o(n).deptSort,"onUpdate:modelValue":e[6]||(e[6]=a=>o(n).deptSort=a),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{span:12},{default:l(()=>[t(s,{label:"负责人",prop:"leader"},{default:l(()=>[t(V,{modelValue:o(n).leader,"onUpdate:modelValue":e[7]||(e[7]=a=>o(n).leader=a),placeholder:"请输入负责人",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{span:12},{default:l(()=>[t(s,{label:"联系电话",prop:"phone"},{default:l(()=>[t(V,{modelValue:o(n).phone,"onUpdate:modelValue":e[8]||(e[8]=a=>o(n).phone=a),placeholder:"请输入联系电话",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{span:12},{default:l(()=>[t(s,{label:"邮箱",prop:"email"},{default:l(()=>[t(V,{modelValue:o(n).email,"onUpdate:modelValue":e[9]||(e[9]=a=>o(n).email=a),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{span:12},{default:l(()=>[t(s,{label:"部门状态"},{default:l(()=>[t(ue,{modelValue:o(n).statusFlag,"onUpdate:modelValue":e[10]||(e[10]=a=>o(n).statusFlag=a)},{default:l(()=>[(p(!0),R(L,null,Q(o(x),a=>(p(),g(re,{key:a.value,value:a.value},{default:l(()=>[i(O(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}};export{rt as default};
