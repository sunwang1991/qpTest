import{a8 as I,a4 as V,ab as A,D as b,bi as $,ar as O,r as L,bT as j,bb as P,aq as F,f as i,dj as y,p as E,a3 as U,dk as B,dl as D,bS as M,ap as R,a6 as v,az as q,I as Y,c as G,o as W,w as o,k as p,q as J,E as X,A as k,P as d,dm as z}from"./index-G7k4jObO.js";import{E as Z}from"./el-row-ErebF3jE.js";import{E as H}from"./el-col-B8uK4B1i.js";import{E as K}from"./el-card-BcY2PItb.js";import{E as Q}from"./el-image-viewer-Buxphrfo.js";import{E as ee,u as te,a as ae,d as le,b as ne}from"./file-CYYxLEvu.js";import"./_baseClone-BzXbRH51.js";const se=V({prefixCls:{type:String}}),T=I({name:"ElSpaceItem",props:se,setup(n,{slots:l}){const h=A("space"),u=b(()=>`${n.prefixCls||h.b()}__item`);return()=>$("div",{class:u.value},O(l,"default"))}}),N={small:8,default:12,large:16};function ie(n){const l=A("space"),h=b(()=>[l.b(),l.m(n.direction),n.class]),u=L(0),f=L(0),_=b(()=>{const a=n.wrap||n.fill?{flexWrap:"wrap"}:{},e={alignItems:n.alignment},t={rowGap:`${f.value}px`,columnGap:`${u.value}px`};return[a,e,t,n.style]}),m=b(()=>n.fill?{flexGrow:1,minWidth:`${n.fillRatio}%`}:{});return j(()=>{const{size:a="small",wrap:e,direction:t,fill:s}=n;if(P(a)){const[r=0,c=0]=a;u.value=r,f.value=c}else{let r;F(a)?r=a:r=N[a||"small"]||N.small,(e||s)&&t==="horizontal"?u.value=f.value=r:t==="horizontal"?(u.value=r,f.value=0):(f.value=r,u.value=0)}}),{classes:h,containerStyle:_,itemStyle:m}}const oe=V({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:v([String,Object,Array]),default:""},style:{type:v([String,Array,Object]),default:""},alignment:{type:v(String),default:"center"},prefixCls:{type:String},spacer:{type:v([Object,String,Number,Array]),default:null,validator:n=>U(n)||F(n)||R(n)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:M,validator:n=>F(n)||P(n)&&n.length===2&&n.every(F)}}),re=I({name:"ElSpace",props:oe,setup(n,{slots:l}){const{classes:h,containerStyle:u,itemStyle:f}=ie(n);function _(m,a="",e=[]){const{prefixCls:t}=n;return m.forEach((s,r)=>{B(s)?P(s.children)&&s.children.forEach((c,g)=>{B(c)&&P(c.children)?_(c.children,`${a+g}-`,e):e.push(i(T,{style:f.value,prefixCls:t,key:`nested-${a+g}`},{default:()=>[c]},y.PROPS|y.STYLE,["style","prefixCls"]))}):D(s)&&e.push(i(T,{style:f.value,prefixCls:t,key:`LoopKey${a+r}`},{default:()=>[s]},y.PROPS|y.STYLE,["style","prefixCls"]))}),e}return()=>{var m;const{spacer:a,direction:e}=n,t=O(l,"default",{key:0},()=>[]);if(((m=t.children)!=null?m:[]).length===0)return null;if(P(t.children)){let s=_(t.children);if(a){const r=s.length-1;s=s.reduce((c,g,w)=>{const x=[...c,g];return w!==r&&x.push(i("span",{style:[f.value,e==="vertical"?"width: 100%":null],key:w},[U(a)?a:E(a,y.TEXT)],y.STYLE)),x},[])}return i("div",{class:h.value,style:u.value},s,y.STYLE|y.CLASS)}return t.children}}}),de=q(re),ue={class:"app-container"},_e={__name:"index",setup(n){let l=Y({loading:!1,uploadFilePath:"/src/assets/logo/logo.png",downloadFilePath:"",fileList:[]});function h(){const a=l.downloadFilePath;if(!a){d({message:"下载资源地址为空",type:"warning",duration:3e3});return}le(a).then(e=>{if(console.log(e),e.status===200&&e.data instanceof Blob){d({message:"已完成下载",type:"success",duration:3e3});const t=a.substring(a.lastIndexOf("/")+1);z(e.data,t)}else d({message:e.msg,type:"error",duration:3e3})})}function u(){const a=l.downloadFilePath;if(!a){d({message:"下载资源地址为空",type:"warning",duration:3e3});return}ne(a,5).then(e=>{if(console.log(e),e instanceof Blob){d({message:"已完成下载",type:"success",duration:3e3});const t=a.substring(a.lastIndexOf("/")+1);z(e,t)}else d({message:e.msg,type:"error",duration:3e3})})}function f(a){if(l.loading)return!1;const e=["image/jpeg","image/png"].includes(a.type);e||d({message:"只支持上传图片格式（jpg、png）",type:"error",duration:3e3});const t=a.size/1024/1024<2;return t||d({message:"图片文件大小必须小于 2MB",type:"error",duration:3e3}),e&&t}function _(a){k.confirm("确认要上传文件吗?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{l.loading=!0;let e=new FormData;e.append("file",a.file),e.append("subPath","default"),te(e).then(t=>{t.data?(d({message:"文件上传成功！",type:"success",duration:3e3}),l.uploadFilePath=t.data.url,l.downloadFilePath=t.data.filePath):d({message:t.msg,type:"error",duration:3e3})})}).finally(()=>{l.loading=!1})}function m(a){const e=a.file,t=l.fileList.find(s=>s.name===e.name);k.confirm("确认要进行分片上传文件吗?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{l.loading=!0,ae(e,4,"default").then(s=>{s.data?(d({message:"文件上传成功！",type:"success",duration:3e3}),t&&(t.url=s.data.url,t.name=s.data.newFileName,t.percentage=100,t.status="success",l.downloadFilePath=s.data.filePath)):(d({message:s.msg,type:"error",duration:3e3}),l.fileList.splice(l.fileList.length-1,1))}).finally(()=>{l.loading=!1})}).catch(()=>{t&&l.fileList.splice(l.fileList.length-1,1)})}return(a,e)=>{const t=J,s=ee,r=Q,c=de,g=K,w=H,x=X,C=Z;return W(),G("div",ue,[i(C,{gutter:16},{default:o(()=>[i(w,{span:12},{default:o(()=>[i(g,{title:"小文件普通上传",style:{"margin-bottom":"16px"}},{default:o(()=>[i(c,{direction:"vertical",size:16},{default:o(()=>[i(s,{name:"file","list-type":"picture",limit:1,"show-file-list":!1,"before-upload":f,"http-request":_,disabled:p(l).loading},{default:o(()=>[i(t,{type:"default",loading:p(l).loading},{default:o(()=>e[3]||(e[3]=[E(" 选择文件 ")])),_:1},8,["loading"])]),_:1},8,["disabled"]),i(r,{style:{width:"128px",height:"128px"},src:p(l).uploadFilePath},null,8,["src"])]),_:1})]),_:1}),i(g,{title:"大文件分片上传"},{default:o(()=>[i(s,{"file-list":p(l).fileList,"onUpdate:fileList":e[0]||(e[0]=S=>p(l).fileList=S),name:"file","list-type":"text","http-request":m,disabled:p(l).loading},{default:o(()=>[i(t,{loading:p(l).loading},{default:o(()=>e[4]||(e[4]=[E(" 选择文件 ")])),_:1},8,["loading"])]),_:1},8,["file-list","disabled"])]),_:1})]),_:1}),i(w,{span:12},{default:o(()=>[i(g,{title:"文件下载",style:{"margin-bottom":"16px"}},{default:o(()=>[i(C,{gutter:8},{default:o(()=>[i(w,{span:24,style:{"margin-bottom":"16px"}},{default:o(()=>[i(x,{style:{"margin-bottom":"16px"},type:"text",placeholder:"输入资源地址，列如：/upload/default/2024/12/xxx.png",modelValue:p(l).downloadFilePath,"onUpdate:modelValue":e[1]||(e[1]=S=>p(l).downloadFilePath=S)},{append:o(()=>[i(t,{type:"primary",onClick:h},{default:o(()=>e[5]||(e[5]=[E(" 普通下载 ")])),_:1})]),_:1},8,["modelValue"]),i(x,{type:"text",placeholder:"输入资源地址，列如：/upload/default/2024/12/xxx.png",modelValue:p(l).downloadFilePath,"onUpdate:modelValue":e[2]||(e[2]=S=>p(l).downloadFilePath=S)},{append:o(()=>[i(t,{type:"primary",onClick:u},{default:o(()=>e[6]||(e[6]=[E(" 分片下载 ")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}};export{_e as default};
